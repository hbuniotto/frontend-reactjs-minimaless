{"ast":null,"code":"var _jsxFileName = \"/Users/humbertobuniotto/Desktop/Ironhack/Module3/frontend-reactjs-minimaless/src/context/AuthContext/AuthProvider.js\";\nimport React, { useReducer } from 'react';\nimport AuthContext from './AuthContext';\nimport AuthReducer from './AuthReducer';\nimport Axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport setAuthToken from 'common/setAuthToken';\n\nconst AuthProvider = props => {\n  const initialState = {\n    isAuthenticated: false,\n    user: {},\n    emailError: ''\n  };\n  const [state, dispatch] = useReducer(AuthReducer, initialState);\n\n  const userAuthentication = token => {\n    // Set token to ls\n    localStorage.setItem('jwtToken', token); // Set token to Auth header\n\n    setAuthToken(token); // Decode token to get user data\n\n    const decoded = jwt_decode(token);\n    dispatch(setCurrentUser(decoded));\n  };\n\n  const signUp = async (userData, history) => {\n    try {\n      const res = await Axios.post('/api/signup', userData);\n      const {\n        token\n      } = res.data;\n      userAuthentication(token);\n      history.push('/listings');\n    } catch (err) {\n      dispatch({\n        type: 'GET_ERRORS',\n        payload: err.response.data.message\n      });\n      console.log(err.response.data.message);\n    }\n  };\n\n  const signIn = async (userData, history) => {\n    try {\n      const res = await Axios.post('/api/login', userData);\n      const {\n        token\n      } = res.data;\n      userAuthentication(token);\n      history.push('/listings');\n    } catch (err) {\n      dispatch({\n        type: 'GET_ERRORS',\n        payload: err.response.data\n      });\n      console.log(err.response.data);\n    }\n  }; // Set logged in user\n\n\n  const setCurrentUser = decoded => {\n    return {\n      type: 'SET_CURRENT_USER',\n      payload: decoded\n    };\n  };\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      isAuthenticated: state.isAuthenticated,\n      user: state.user,\n      emailError: state.emailError,\n      signUp: signUp,\n      signIn: signIn,\n      setCurrentUser: setCurrentUser\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, props.children);\n};\n\nexport default AuthProvider;","map":{"version":3,"sources":["/Users/humbertobuniotto/Desktop/Ironhack/Module3/frontend-reactjs-minimaless/src/context/AuthContext/AuthProvider.js"],"names":["React","useReducer","AuthContext","AuthReducer","Axios","jwt_decode","setAuthToken","AuthProvider","props","initialState","isAuthenticated","user","emailError","state","dispatch","userAuthentication","token","localStorage","setItem","decoded","setCurrentUser","signUp","userData","history","res","post","data","push","err","type","payload","response","message","console","log","signIn","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\r\nimport AuthContext from './AuthContext';\r\nimport AuthReducer from './AuthReducer';\r\nimport Axios from 'axios';\r\nimport jwt_decode from 'jwt-decode';\r\nimport setAuthToken from 'common/setAuthToken';\r\n\r\nconst AuthProvider = props => {\r\n    const initialState = {\r\n        isAuthenticated: false,\r\n        user: {},\r\n        emailError: ''\r\n      };\r\n\r\n    const [state, dispatch] = useReducer(AuthReducer, initialState);\r\n\r\n    const userAuthentication = (token) => {\r\n        // Set token to ls\r\n        localStorage.setItem('jwtToken', token);\r\n        // Set token to Auth header\r\n        setAuthToken(token);\r\n        // Decode token to get user data\r\n        const decoded = jwt_decode(token);\r\n        dispatch(setCurrentUser(decoded));\r\n      }\r\n\r\n    const signUp = async(userData, history) => {\r\n        try {\r\n            const res = await Axios.post('/api/signup', userData)\r\n            const { token } = res.data;\r\n                userAuthentication(token)\r\n                history.push('/listings')\r\n        } catch(err) {\r\n            dispatch({ type: 'GET_ERRORS', payload: err.response.data.message });\r\n            console.log(err.response.data.message)\r\n        }\r\n    }\r\n\r\n    const signIn = async(userData, history) => {\r\n        try {\r\n            const res = await Axios.post('/api/login', userData)\r\n            const { token } = res.data;\r\n                userAuthentication(token)\r\n                history.push('/listings')\r\n        } catch(err) {\r\n            dispatch({ type: 'GET_ERRORS', payload: err.response.data });\r\n            console.log(err.response.data)\r\n        }\r\n    }\r\n\r\n// Set logged in user\r\n    const setCurrentUser = decoded => {\r\n        return {\r\n            type: 'SET_CURRENT_USER',\r\n            payload: decoded\r\n        };\r\n    };\r\n\r\n\r\n    return (\r\n        <AuthContext.Provider\r\n            value={{\r\n                isAuthenticated: state.isAuthenticated,\r\n                user: state.user,\r\n                emailError: state.emailError,\r\n                signUp: signUp,\r\n                signIn: signIn,\r\n                setCurrentUser: setCurrentUser\r\n            }}\r\n        >\r\n            {props.children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport default AuthProvider;\r\n"]},"metadata":{},"sourceType":"module"}