{"ast":null,"code":"var _jsxFileName = \"/Users/humbertobuniotto/Desktop/Ironhack/Module3/frontend-reactjs-minimaless/src/views/NewListing/components/NewListingDetails/NewListingDetails.js\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ListDetails from './components/ListDetails';\nimport Pictures from './components/Pictures';\nimport PriceList from './components/PriceList';\nimport AlertNotify from './components/AlertNotify';\nimport { Grid, Stepper, Step, StepLabel, Button } from '@material-ui/core';\nimport { withRouter } from 'react-router-dom';\nimport ListingContext from 'context/Listing/ListingContext';\nimport Axios from 'axios';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '80%'\n  },\n  btnGroup: {\n    textAlign: 'center',\n    marginTop: 50\n  },\n  button: {\n    marginRight: theme.spacing(1)\n  },\n  instructions: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  }\n}));\n\nfunction getSteps() {\n  return ['Listing Details', 'Pictures', 'Price & List'];\n}\n\nconst NewListingDetails = props => {\n  const classes = useStyles();\n  const [activeStep, setActiveStep] = useState(0);\n  const steps = getSteps();\n  const [formState, setFormState] = useState({\n    isValid: true,\n    values: {\n      title: '',\n      brand: '',\n      description: '',\n      size: '',\n      condition: '',\n      category: '',\n      occasion: '',\n      color: '',\n      price: ''\n    },\n    images: [],\n    imagasSuccess: false\n  });\n  const listingContext = useContext(ListingContext);\n  const {\n    addList\n  } = listingContext;\n  const [profile, setProfile] = useState({});\n  useEffect(() => {\n    Axios.get('/api/profile').then(res => {\n      setProfile(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n  useEffect(() => {\n    const errors = isFormValid(formState.values);\n    setFormState(formState => ({ ...formState,\n      isValid: errors ? false : true,\n      errors: errors || {}\n    }));\n  }, [formState.values]);\n\n  const handleChange = event => {\n    event.persist();\n    setFormState(formState => ({ ...formState,\n      values: { ...formState.values,\n        [event.target.name]: event.target.type === 'checkbox' ? event.target.checked : event.target.value\n      }\n    }));\n  };\n\n  const isFormValid = data => {\n    const {\n      title,\n      brand,\n      description,\n      size,\n      condition,\n      category,\n      occasion,\n      color\n    } = data;\n\n    if (!title || !brand || !description || !size || !condition || !category || !occasion || !color) {\n      return true;\n    }\n\n    return false;\n  };\n\n  const handleSubmit = () => {\n    const listingData = {\n      title: formState.values.title,\n      brand: formState.values.brand,\n      description: formState.values.description,\n      size: formState.values.size,\n      condition: formState.values.condition,\n      category: formState.values.category,\n      occasion: formState.values.occasion,\n      color: formState.values.color,\n      price: formState.values.price,\n      images: formState.images,\n      user: profile.user,\n      profile: profile._id\n    };\n    addList(listingData);\n    setTimeout(() => {\n      props.history.push('/listings');\n    }, 2000);\n    setActiveStep(prevActiveStep => prevActiveStep + 1);\n  };\n\n  const handleBack = () => {\n    setActiveStep(prevActiveStep => prevActiveStep - 1);\n  };\n\n  const handleNext = () => {\n    setActiveStep(prevActiveStep => prevActiveStep + 1);\n  };\n\n  const imagesHandler = images => {\n    setFormState(formState => ({ ...formState,\n      images\n    }));\n  }; // console.log(profile._id)\n  // console.log(profile)\n\n\n  const getStepContent = step => {\n    switch (step) {\n      case 0:\n        return /*#__PURE__*/React.createElement(ListDetails, {\n          handleChange: handleChange,\n          formState: formState,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 16\n          }\n        });\n\n      case 1:\n        return /*#__PURE__*/React.createElement(Pictures, {\n          formState: formState,\n          imagesHandler: images => imagesHandler(images),\n          reset: formState.imagasSuccess,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 16\n          }\n        });\n\n      case 2:\n        return /*#__PURE__*/React.createElement(PriceList, {\n          handleChange: handleChange,\n          formState: formState,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 16\n          }\n        });\n\n      default:\n        return 'What are you trying to do!?';\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Stepper, {\n    activeStep: activeStep,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }\n  }, steps.map((label, index) => {\n    const stepProps = {};\n    const labelProps = {};\n    return /*#__PURE__*/React.createElement(Step, Object.assign({\n      key: label\n    }, stepProps, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(StepLabel, Object.assign({}, labelProps, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 15\n      }\n    }), label));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }\n  }, activeStep === steps.length ? /*#__PURE__*/React.createElement(AlertNotify, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    className: classes.instructions,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, getStepContent(activeStep)), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.btnGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    disabled: activeStep === 0,\n    onClick: handleBack,\n    className: classes.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 15\n    }\n  }, \"Back\"), activeStep === 0 ? /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: handleNext,\n    disabled: !formState.isValid,\n    className: classes.buttonNext,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 15\n    }\n  }, \"Next\") : '', activeStep === 1 ? /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    disabled: formState.images.length !== 5,\n    onClick: handleNext,\n    className: classes.buttonNext,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 15\n    }\n  }, \"Next\") : '', activeStep === 2 ? /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    disabled: formState.values.price === '',\n    onClick: handleSubmit,\n    className: classes.buttonNext,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 15\n    }\n  }, \"Finish\") : ''))));\n};\n\nexport default withRouter(NewListingDetails); // REFACTOR REDIRECT TO LISTINS PAGE","map":{"version":3,"sources":["/Users/humbertobuniotto/Desktop/Ironhack/Module3/frontend-reactjs-minimaless/src/views/NewListing/components/NewListingDetails/NewListingDetails.js"],"names":["React","useState","useEffect","useContext","makeStyles","ListDetails","Pictures","PriceList","AlertNotify","Grid","Stepper","Step","StepLabel","Button","withRouter","ListingContext","Axios","useStyles","theme","root","width","btnGroup","textAlign","marginTop","button","marginRight","spacing","instructions","marginBottom","getSteps","NewListingDetails","props","classes","activeStep","setActiveStep","steps","formState","setFormState","isValid","values","title","brand","description","size","condition","category","occasion","color","price","images","imagasSuccess","listingContext","addList","profile","setProfile","get","then","res","data","catch","err","console","log","errors","isFormValid","handleChange","event","persist","target","name","type","checked","value","handleSubmit","listingData","user","_id","setTimeout","history","push","prevActiveStep","handleBack","handleNext","imagesHandler","getStepContent","step","map","label","index","stepProps","labelProps","length","buttonNext"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport ListDetails from './components/ListDetails'\r\nimport Pictures from './components/Pictures';\r\nimport PriceList from './components/PriceList';\r\nimport AlertNotify from './components/AlertNotify';\r\nimport { Grid, Stepper, Step, StepLabel, Button } from '@material-ui/core';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport ListingContext from 'context/Listing/ListingContext';\r\nimport Axios from 'axios';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: '80%',\r\n  },\r\n  btnGroup: {\r\n    textAlign: 'center',\r\n    marginTop: 50\r\n  },\r\n  button: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  instructions: {\r\n    marginTop: theme.spacing(1),\r\n    marginBottom: theme.spacing(1),\r\n  },\r\n}));\r\n\r\nfunction getSteps() {\r\n  return ['Listing Details', 'Pictures', 'Price & List'];\r\n}\r\n\r\nconst NewListingDetails = (props) => {\r\n  const classes = useStyles();\r\n  const [activeStep, setActiveStep] = useState(0);\r\n  const steps = getSteps();\r\n\r\n  const [formState, setFormState] = useState({\r\n    isValid: true,\r\n    values: {\r\n      title: '',\r\n      brand: '',\r\n      description: '',\r\n      size: '',\r\n      condition: '',\r\n      category: '',\r\n      occasion: '',\r\n      color: '',\r\n      price: ''\r\n    },\r\n    images: [],\r\n    imagasSuccess: false\r\n  });\r\n\r\n  const listingContext = useContext(ListingContext);\r\n  const { addList } = listingContext;\r\n\r\n  const [profile, setProfile] = useState({})\r\n\r\n  useEffect(() => {\r\n    Axios.get('/api/profile').then(res => {\r\n      setProfile(res.data)\r\n    }).catch(err => {\r\n      console.log(err)\r\n    })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const errors = isFormValid(formState.values);\r\n\r\n    setFormState(formState => ({\r\n      ...formState,\r\n      isValid: errors ? false : true,\r\n      errors: errors || {}\r\n    }));\r\n  }, [formState.values]);\r\n\r\n  \r\n  const handleChange = event => {\r\n    event.persist();\r\n    setFormState(formState => ({\r\n      ...formState,\r\n      values: {\r\n        ...formState.values,\r\n        [event.target.name]:\r\n          event.target.type === 'checkbox'\r\n            ? event.target.checked\r\n            : event.target.value\r\n      },\r\n    }));\r\n  };\r\n\r\n  const isFormValid = (data) => {\r\n    const {title, brand, description, size, condition, category, occasion, color} = data\r\n\r\n    if(!title || !brand || !description || !size || !condition || !category || !occasion || !color) {\r\n      return true\r\n    }\r\n    return false\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    const listingData = {\r\n      title: formState.values.title,\r\n      brand: formState.values.brand,\r\n      description: formState.values.description,\r\n      size: formState.values.size,\r\n      condition: formState.values.condition,\r\n      category: formState.values.category,\r\n      occasion: formState.values.occasion,\r\n      color: formState.values.color,\r\n      price: formState.values.price,\r\n      images: formState.images,\r\n      user: profile.user,\r\n      profile: profile._id,\r\n    }\r\n    addList(listingData)\r\n    setTimeout(() => {\r\n      props.history.push('/listings')\r\n    }, 2000);\r\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n  }\r\n\r\n  const handleBack = () => {\r\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\r\n  };\r\n\r\n  const handleNext = () => {\r\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n  };\r\n\r\n  const imagesHandler = (images) => {\r\n    setFormState(formState => ({\r\n      ...formState,\r\n      images\r\n    }));\r\n  }\r\n\r\n// console.log(profile._id)\r\n// console.log(profile)\r\n\r\n  const getStepContent = (step) => {\r\n    switch (step) {\r\n      case 0:\r\n        return <ListDetails handleChange={handleChange} formState={formState} />;\r\n      case 1:\r\n        return <Pictures formState={formState} imagesHandler={images => imagesHandler(images)} reset={formState.imagasSuccess} />;\r\n      case 2:\r\n        return <PriceList handleChange={handleChange} formState={formState} />;\r\n      default:\r\n        return 'What are you trying to do!?';\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Stepper activeStep={activeStep}>\r\n        {steps.map((label, index) => {\r\n          const stepProps = {};\r\n          const labelProps = {};\r\n          return (\r\n            <Step key={label} {...stepProps}>\r\n              <StepLabel {...labelProps}>{label}</StepLabel>\r\n            </Step>\r\n          );\r\n        })}\r\n      </Stepper>\r\n\r\n      <div>\r\n        {activeStep === steps.length ? (\r\n          <AlertNotify  />\r\n        ) : (\r\n          <div>\r\n            <Grid className={classes.instructions}>{getStepContent(activeStep)}</Grid>\r\n            <div className={classes.btnGroup}>\r\n              <Button disabled={activeStep === 0} onClick={handleBack} className={classes.button}>\r\n                Back\r\n              </Button>\r\n            {\r\n            activeStep === 0 ? \r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                onClick={handleNext}\r\n                disabled={!formState.isValid}\r\n                className={classes.buttonNext}\r\n              >Next</Button> : ''\r\n            }\r\n            {\r\n            activeStep === 1 ? \r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                disabled={formState.images.length !== 5}\r\n                onClick={handleNext}\r\n                className={classes.buttonNext}\r\n              >Next</Button> : ''\r\n            }\r\n            {\r\n            activeStep === 2 ? \r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                disabled={formState.values.price === ''}\r\n                onClick={handleSubmit}\r\n                className={classes.buttonNext}\r\n              >Finish</Button> : ''\r\n            }\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(NewListingDetails)\r\n\r\n// REFACTOR REDIRECT TO LISTINS PAGE"]},"metadata":{},"sourceType":"module"}